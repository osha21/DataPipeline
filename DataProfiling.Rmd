---
title: "DataAnalysis"
output: html_document
date: "2025-11-23"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## load csv files
eng <- read.csv("Engagement.csv")
agency <- read.csv("SenseofAgency.csv")

## calculate averages (skip first column)
eng$Engagement_Avg <- rowMeans(eng[ , -1], na.rm = TRUE)
agency$Agency_Avg  <- rowMeans(agency[ , -1], na.rm = TRUE)

## build combined dataframe
df <- data.frame(
  Participant = eng[[1]],        # keep original participant number
  Engagement  = eng$Engagement_Avg,
  Agency      = agency$Agency_Avg
)

## compute medians
eng_median    <- median(df$Engagement, na.rm = TRUE)
agency_median <- median(df$Agency,    na.rm = TRUE)

## make profiles
df$Engagement_Group <- ifelse(df$Engagement >= 3,
                              "High Engagement", "Low Engagement")
df$Agency_Group <- ifelse(df$Agency >= 3,
                          "High Agency", "Low Agency")

df$Profile4 <- paste(df$Engagement_Group, df$Agency_Group, sep = " / ")

## collapse to 3 profiles (example: merge all High Engagement into one group)
df$Profile3 <- dplyr::case_when(
  df$Profile4 == "Low Engagement / Low Agency"  ~ "Low Engagement / Low Agency",
  df$Profile4 == "Low Engagement / High Agency" ~ "Low Engagement / High Agency",
  TRUE                                         ~ "High Engagement / High Agency"
)

library(ggplot2)

ggplot(df, aes(x = Agency, y = Engagement, color = Profile3)) +
  geom_point(size = 3) +
  geom_hline(yintercept = 3, linetype = "dashed") +
  geom_vline(xintercept = 3, linetype = "dashed") +
  xlim(1, 5) +
  ylim(1, 5) +
  labs(
    title = "Engagement vs Agency (3 Conceptual Profiles)",
    x = "Average Agency Score",
    y = "Average Engagement Score",
    color = "Profile"
  ) +
  theme_minimal()

